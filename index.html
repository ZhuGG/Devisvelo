<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <title>Extracteur de pi√®ces ‚Äì Devis v√©lo (PDF)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="assets/css/main.css" />
</head>
<body>
  <div class="app-shell">
    <header>
      <div>
        <h1>Extracteur de pi√®ces ‚Äî devis v√©lo (PDF)</h1>
        <p class="subtitle">
          D√©pose un PDF contenant un ou plusieurs devis. L‚Äôanalyse reste locale dans ton navigateur.
        </p>
      </div>
      <div class="badge">
        <span class="badge-dot"></span>
        <span>Local ‚Ä¢ Offline</span>
      </div>
    </header>

    <main>
      <section class="card">
        <div class="card-content">
          <div class="card-header">
            <div>
              <div class="card-kicker">√âtape 1</div>
              <div class="card-title">D√©poser le PDF de devis</div>
            </div>
          </div>
          <p class="card-description">
            Format attendu : tableau <strong>ARTICLES / QT√â / PU / TVA / TOTAL</strong> comme dans ton exemple.
            Chaque ligne d‚Äôarticle peut avoir une ou plusieurs lignes de description, suivies d‚Äôune ligne chiffr√©e.
          </p>

          <label class="drop-zone" id="dropZone">
            <div class="drop-icon">üìÑ</div>
            <div class="drop-title">Glisse ton fichier PDF ici</div>
            <div class="drop-subtitle">
              ou clique pour le s√©lectionner<br />
              <span class="drop-subtitle-note">
                Un seul PDF √† la fois (plusieurs pages possibles).
              </span>
            </div>
            <button type="button" class="btn btn-secondary" id="browseButton">
              Parcourir‚Ä¶
            </button>
            <input
              type="file"
              class="file-input"
              id="fileInput"
              accept="application/pdf"
            />
          </label>

          <div class="preview-wrapper">
            <canvas id="previewCanvas"></canvas>
            <div class="preview-caption">
              Aper√ßu de la premi√®re page pour v√©rifier que tu as le bon document.
            </div>
          </div>
        </div>
      </section>

      <section class="card">
        <div class="card-content">
          <div class="card-header card-header--spaced">
            <div>
              <div class="card-kicker">√âtape 2</div>
              <div class="card-title">R√©capitulatif des pi√®ces extraites</div>
            </div>
            <button class="btn" id="exportButton" disabled>
              Exporter en CSV
            </button>
          </div>
          <p class="card-description">
            L‚Äôalgorithme rep√®re le bloc <strong>ARTICLES / QT√â / PU / TVA / TOTAL</strong>,
            reconstruit la description d‚Äôarticle et additionne les quantit√©s sur l‚Äôensemble du PDF.
          </p>

          <div class="stats-row" id="statsRow">
            <div class="stat-pill">
              Pages analys√©es :
              <span class="value" id="statPages">0</span>
            </div>
            <div class="stat-pill">
              Lignes trouv√©es :
              <span class="value" id="statRows">0</span>
            </div>
            <div class="stat-pill">
              Articles uniques :
              <span class="value" id="statItems">0</span>
            </div>
          </div>

          <div id="resultsContainer">
            <div class="empty-state" id="emptyState">
              Aucun PDF analys√© pour le moment.<br />
              Commence par d√©poser un devis √† gauche.
            </div>

            <div class="results-wrapper" id="resultsWrapper">
              <table>
                <thead>
                  <tr>
                    <th>Article</th>
                    <th class="qty-header">Quantit√© totale</th>
                  </tr>
                </thead>
                <tbody id="resultsBody"></tbody>
              </table>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer>
      v1 ‚Äî Lecture PDF c√¥t√© client avec PDF.js. Pens√© pour les devis type Ateliers de l‚Äôaudace.
    </footer>
  </div>

  <div class="toast" id="toast"></div>

  <script type="module" src="assets/js/main.js"></script>
</body>
</html>
